<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Barcode</title>

<style>
  body {
    margin: 0;
    min-height: 100vh;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: linear-gradient(135deg, #fdf6e3, #e0f2f1);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .card {
    background: white;
    padding: 24px;
    border-radius: 16px;
    width: 100%;
    max-width: 420px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
  }

  h1 {
    margin-top: 0;
    color: #2a7f62;
    text-align: center;
  }

  p {
    color: #555;
    font-size: 0.9rem;
    text-align: center;
  }

  input, button {
    width: 100%;
    padding: 12px;
    font-size: 1rem;
    border-radius: 10px;
    border: 1px solid #ccc;
    margin-top: 10px;
    box-sizing: border-box;
  }

  button {
    background: #2a7f62;
    color: white;
    border: none;
    cursor: pointer;
  }

  button:hover {
    background: #256d55;
  }

  .suggestions {
    font-size: 0.85rem;
    color: #555;
    margin-top: 6px;
  }

  .slider {
    margin-top: 14px;
    font-size: 0.85rem;
  }

  .result {
    margin-top: 16px;
    padding: 14px;
    background: #e0f2f1;
    border-radius: 12px;
    font-size: 0.9rem;
  }

  .label {
    font-weight: 600;
  }

  .feedback {
    display: flex;
    gap: 10px;
    margin-top: 12px;
  }

  .feedback button {
    flex: 1;
    background: #ddd;
    color: #333;
  }
  .modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  display: none;
  align-items: center;
  justify-content: center;
}

.modal-content {
  background: white;
  padding: 20px;
  border-radius: 12px;
  text-align: center;
}
</style>
</head>
<div class="modal" id="scanModal">
  <div class="modal-content">
    <p>üì∏ Scanning barcode...</p>
  </div>
</div>

<body>

<div class="card">
  <h1>Barcode</h1>
  <p>What does that date *actually* mean?</p>

  <!-- Food input -->
  <input id="foodInput" placeholder="milk, eggs, bread..." oninput="showSuggestions()">
  <div class="suggestions" id="suggestions"></div>

  <!-- Fake barcode input -->
  <input placeholder="Tap to scan barcode üì¶" onclick="fakeScan()" readonly>

  <!-- Risk slider -->
  <div class="slider">
    How risky are you?
    <input type="range" min="0" max="2" value="1" id="riskSlider">
    <div id="riskLabel">Moderate</div>
  </div>

  <button onclick="checkFood()">Check food</button>

  <div class="result" id="result"></div>

  <!-- Feedback -->
  <div class="feedback" id="feedback" style="display:none;">
    <button onclick="sendFeedback(true)">üëç Helpful</button>
    <button onclick="sendFeedback(false)">üëé Not really</button>
  </div>
</div>

<script>

window.onload = () => {
  const savedFood = localStorage.getItem("lastFood");
  const savedRisk = localStorage.getItem("riskLevel");

  if (savedFood) {
    foodInput.value = savedFood;
    riskSlider.value = savedRisk || 1;
    checkFood();
  }
};

const foodData = {
  milk: { date: "Sell By", meaning: "Store selling deadline", days: [3,5,7], tip: "Keep cold ü•õ" },
  eggs: { date: "Best By", meaning: "Peak freshness", days: [14,21,28], tip: "Carton in fridge ü•ö" },
  bread:{ date: "Best By", meaning: "Texture & taste", days: [1,3,5], tip: "Freeze extras üçû" },
  cheese:{ date: "Use By", meaning: "Safety-focused", days: [3,7,10], tip: "Wrap tightly üßÄ" },
  yogurt:{ date: "Best By", meaning: "Flavor date", days: [3,7,10], tip: "Smell test üç¶" }
};

const foods = Object.keys(foodData);

function showSuggestions() {
  const input = foodInput.value.toLowerCase();
  const matches = foods.filter(f => f.startsWith(input));
  suggestions.textContent = matches.length ? "Try: " + matches.join(", ") : "";
}

function checkFood() {
  const food = foodInput.value.toLowerCase();
  const risk = riskSlider.value;
  const riskText = ["Conservative", "Moderate", "Adventurous"][risk];
  riskLabel.textContent = riskText;

  if (!foodData[food]) {
    result.innerHTML = "We don‚Äôt have data for that yet üòÖ";
    feedback.style.display = "none";
    return;
  }

  const f = foodData[food];
  result.innerHTML = `
    <div><span class="label">Food:</span> ${food}</div>
    <div><span class="label">Date type:</span> ${f.date}</div>
    <div><span class="label">What it means:</span> ${f.meaning}</div>
    <div><span class="label">Usually good for:</span> ${f.days[risk]} days after</div>
    <div><span class="label">Tip:</span> ${f.tip}</div>
  `;
  feedback.style.display = "flex";

  localStorage.setItem("lastFood", food);
  localStorage.setItem("riskLevel", risk);

}

function sendFeedback(helpful) {
  alert(helpful ? "Thanks! üëç" : "Got it ‚Äî we‚Äôll improve üëÄ");
}

function fakeScan() {
  scanModal.style.display = "flex";
  setTimeout(() => {
    scanModal.style.display = "none";
    foodInput.value = "milk";
    checkFood();
  }, 1500);
}

</script>

</body>
</html>
